seed: 0
device: None                              # Set to 'cpu' or 'cuda' to override automatic device selection

logging:
  log_dir: './experiments/fitting/logs'
  log_every_n_steps: 50
  visualize_every_n_steps: 1000
  no_progress_bar: False

# Space and latents configuration
geometry:
  input_space: 'Position_Orientation'
  metric: # Rot(theta) @ diag(xi**2, xi**2 / epsilon**2, 1) @ Rot(theta)^T
    xi: 1.0
    epsilon: 1.0
  theta_range: 'zero'  # zero=[0, 2pi], shifted=[-pi, pi]
  group: 'SE' # Choises, 'SE', 'E', 'SE-Perm', 'E-Perm'
  dim_orientation: 1 # Choises, 0 to dim_signal
  triv: 'expm' # "expm", "cayley", "projection"
  latent_dim: 64
  num_latents: 25
  clip_pos: True

# Solver configuration
solver:
  num_hidden: 128
  num_heads: 3
  embedding_type: rff                        # Choices, 'linear', 'rff', 'polynomial', 
  embedding_freq_multiplier_invariant: 2     # For SIREN this is the omega value, for RFF the 1/std and for polynomial the degree
  embedding_freq_multiplier_value: 10        # For SIREN this is the omega value, for RFF the 1/std and for polynomial the degree

# Eikonal equiation configuration
eikonal:
  factored: True
  power: 2
  hamiltonian: True

  ground_truth:
    active: True
    skip_r: 1
    skip_s: 5
    num_visualized: 2
    save_data: True
    force_recompute: False
    device: 'gpu'
    sub_riem: False
    n_max: 1e5
    n_max_initialisation: 1e4
    n_check: 2e3
    n_check_initialisation: 2e3
    tol: 1e-3
    initial_condition: 200.0

# Data configuration
data:
  base_dataset:
    name: 'fwi_style_a'
    num_signals_train: 100
    num_signals_test: 50
    test_train: False

  
  # Coordinate dataloader config
  train_batch_size: 2
  test_batch_size: 2
  n_coords: 25000 # same as NES
  num_pairs: 3125 # n_coords/ (batch_size*4)
  x_min: [-1.0, -1.0]
  x_max: [1.0, 1.0]
  num_workers: 0
  pin_memory: True
  train_save_data: True
  train_force_recompute: True
  test_save_data: True
  test_force_recompute: True

  

# Training configuration
training:
  num_epochs: 3000
  model_checkpoint: False
  early_stopping: True


# Testing configuration
test:
  test_every_n_epochs: 100
  num_epochs_auto: 100
  test_train: True

# Optimization configuration
optimizer:
  name: adamw
  learning_rate_solver: 1e-4
  learning_rate_codes: 1e-2
  learning_rate_poses: 1e-3
  weight_decay: 0.0

visualization:
  active: True
  max_num_visualized_rec: 5